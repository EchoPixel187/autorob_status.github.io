<!DOCTYPE html>
<html>
<head>
  <title>Script Logs</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
</head>
<body>

<h2>Logs</h2>
<table border="1" id="table">
  <tr>
    <th>User ID</th>
    <th>Username</th>
    <th>Time</th>
  </tr>
</table>

<script>
const supabaseClient = supabase.createClient(
  "https://mpalntykgnflxqbswykw.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1wYWxudHlrZ25mbHhxYnN3eWt3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE0Mzk4OTcsImV4cCI6MjA4NzAxNTg5N30.qw5jyCIdKB9q9Tjp12Oxhwo1DBX_NCISugf_ahB-9lw"
)

async function loadLogs() {
  const { data, error } = await supabaseClient
    .from('EH_Admin_Stats')
    .select('*')
    .order('created_at', { ascending: false })

  if (error) {
    console.error("Supabase Error:", error)
    return
  }

  const table = document.getElementById("table")

  table.innerHTML = `
    <tr>
      <th>User ID</th>
      <th>Username</th>
      <th>Time</th>
    </tr>
  `

  if (!data || data.length === 0) {
    table.innerHTML += `<tr><td colspan="3">Keine Logs gefunden</td></tr>`
    return
  }

  data.forEach(row => {
    table.innerHTML += `
      <tr>
        <td>${row.user_id}</td>
        <td>${row.username}</td>
        <td>${row.created_at}</td>
      </tr>
    `
  })
}

loadLogs()
setInterval(loadLogs, 10000)
</script>

</body>
</html>
